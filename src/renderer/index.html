<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Desktop</title>
    <link rel="stylesheet" href="./modern-ui.css">
</head>
<body>
    <header class="app-header">
        <div class="container header-content">
            <div class="app-logo">MCP Desktop</div>
            <div id="status-indicators"></div>
        </div>
    </header>
    
    <div class="app-container">
        <!-- Sidebar with Microsoft 365 Integration Status -->
        <aside class="sidebar" id="app-sidebar">
            <div id="integration-status" class="card">
                <div class="card-header">
                    <h3 class="card-title">Microsoft 365 Integration</h3>
                </div>
                <div class="card-body">
                    <div class="connection-buttons">
                        <button id="debug-mail-btn" class="btn btn-primary">Test Mail API</button>
                        <button id="debug-calendar-btn" class="btn btn-secondary">Test Calendar API</button>
                        <button id="debug-files-btn" class="btn btn-accent">Test Files API</button>
                    </div>
                    <div id="test-results" class="test-results mt-4 hidden"></div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">System Details</h3>
                </div>
                <div class="card-body">
                    <div id="system-info">
                        <p><strong>Version:</strong> 2.5.0</p>
                        <p><strong>Environment:</strong> Production</p>
                        <p><strong>Last Updated:</strong> May 16, 2025</p>
                    </div>
                </div>
            </div>
        </aside>
        
        <!-- Main content area -->
        <main class="main-content">
            <!-- App container where dynamic content will be rendered -->
            <div id="app"></div>
        </main>
    </div>
    
    <!-- Global services (load first) -->
    <script src="./services/global-services.js"></script>
    
    <!-- Import DOM security utilities -->
    <script src="./dom-safe.js" type="module"></script>
    
    <!-- Import UI notification system -->
    <script src="./ui-notification.js" type="module"></script>
    
    <!-- Import the new modular application -->
    <script src="./services/IPCService.js" type="module"></script>
    <script src="./modules/APIService.js" type="module"></script>
    <script src="./modules/UIManager.js" type="module"></script>
    <script src="./modules/ConnectionManager.js" type="module"></script>
    <script src="./modules/AppController.js" type="module"></script>
    
    <!-- Initialize the application -->
    <script type="module">
        import { AppController } from './modules/AppController.js';
        
        // Initialize the application when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            const appController = new AppController();
            appController.init();
        });
    </script>
</body>
</html>
